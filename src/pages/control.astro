---
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero.astro";
import Clutches from "../components/Clutches.html";
import "../styles/control.css";

// 獲取 URL 參數
const url = new URL(Astro.request.url);
const username = url.searchParams.get('username');
const token = url.searchParams.get('token');

// 檢查登入狀態
const isLoggedIn = !!username && !!token;

// 如果未登入，重定向到登入頁面
if (!isLoggedIn) {
  return Astro.redirect(`/tymultiverse/login?redirect=${encodeURIComponent(Astro.url.pathname + Astro.url.search)}`);
}
---

<!DOCTYPE html>
<meta charset="UTF-8" />
<html>
  <head>
  </head>
  <body>
    <BaseLayout
      title="Control | Wavo Yuropha"
    >
      <div class="stack gap-20">
        <main class="wrapper stack gap-8">
          <Hero title="Control" align="start" />
          <div class="icon-container">
            <a
              href="https://peoplesystem.tatdvsonorth.com/sso/admin/master/console/"
              class="control-box"
              target="_blank"
            >
              <img src="/tymultiverse/icons/admin-console.svg" alt="Admin Console" />
            </a>
            <a
              href="https://peoplesystem.tatdvsonorth.com/grafana/d/fe9ygfuj61nnkc/apiserver?orgId=1&from=now-6h&to=now&timezone=browser"
              class="control-box"
              target="_blank"
            >
              <img src="/tymultiverse/icons/grafana.svg" alt="Grafana" />
            </a>
            <a
              href="https://peoplesystem.tatdvsonorth.com/jenkins/"
              class="control-box"
              target="_blank"
            >
              <img src="/tymultiverse/icons/jenkins.svg" alt="Jenkins" />
            </a>
          </div>

          <Clutches />
        </main>
      </div>
      <script>
      
      </script>
    </BaseLayout>
  </body>
</html>
